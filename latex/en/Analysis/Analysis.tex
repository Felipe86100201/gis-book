
\chapter{Spatial analysis}



\pagestyle{fancy}

Analysis is one of the key capabilities of GIS. Spatial analysis is the \textbf{quantitative analysis of phenomena, considering the geometric, geographical or topological properties of their elements}. Properties such as position, distance, or area are relevant when performing spatial analysis.

We perform spatial analysis when we use a classic printed map to search for the highest peak in a given map sheet, read the elevation of a given element such as a city, or plan a turistic activity checking the places to visit and how to move between them using the best roads or following the fastest route. Of course, we can also perform this kind of operations within a GIS.

Analysis generates new data, and that data can be in the form of \textbf{new layers, tables, or simple values}.

The result of an analysis might express \textbf{the same variable} as the original data (for instance, computing the average value), or \textbf{a different one} (for instance, if we compute a slope layer from an elevation layer).

Spatial analysis requires spatial data, which can be of a \textbf{single type}, or, instead, of \textbf{multiple types that are combined}. For instance, in the case of finding the highest point in a map, the result is just a coordinate and the only variable used is the elevation. In the case of computing the average elevation of a city, two variables are used: the elevation and the space occupied by the city (defined, for instance, by a polygon with its boundaries). Although all that information is traditionally contained in a single map sheet, in a GIS they will be in separate layers, both if which will be inputs for this particular analysis.

Analysis in a GIS gives us answers to questions that can be:

\begin{itemize}
 \item Related to position or extension.
\item Related to shape or distribution.
\item Related to spatial associations.
\item Related to spatial interactions.
\item Related to spatial variation.
\end{itemize}

\section{Some examples of spatial analysis}

The following sections describe some common types of spatial analysis.

\subsection{Spatial queries}

We already discussed queries in the chapter devoted to databases.

Queries can be combined with other analysis tools, for instance, to \textbf{select} a subset of feature with which we will later perform some other analysis.

\subsection{Topological analysis}

Pueden plantearse consultas referidas no solo a la posición de los elementos geográficos, sino a la \textbf{relación con otros elementos}. La existencia de topología puede emplearse para la realización de consultas que respondan a cuestiones como:

\begin{itemize}
\item ¿Cómo llegar desde mi posición actual hasta una coordenada concreta por la red viaria existente?

\item ¿Qué comunidades autónomas comparten límite con Madrid?
\end{itemize}

\subsection{Medición} 

La existencia de una referencia espacial para cada uno de los elementos con los que trabajamos en el análisis dentro de un SIG hace que podamos \textbf{cuantificar} otra serie de parámetros también espaciales. Entre las mediciones más básicas, encontramos las distancias, áreas, perímetros o factores de forma. Mas elaboradas, encontramos otras como pendientes o indices derivados de medidas simples.


\subsection{Combinación}

Uno de los procedimientos más habituales y más característicos dentro del uso de un SIG es la \textbf{combinación o superposición} de varias capas de información. La propia estructura de la información geográfica en capas facilita notablemente estos procedimientos y convierte a los SIG en plataformas ideales para llevar a cabo análisis donde se combina información sobre diversas variables.

En el caso de capas vectoriales, las \textbf{operaciones de solape} tales como \textbf{unión, intersección, diferencia o recorte}, son habituales. La figura \ref{Fig:Interseccion} muestra un ejemplo de la operación de intersección con dos capas de polígonos.

\begin{figure}[!hbt]   
\centering
\includegraphics[width= \columnwidth]{Analysis/Intersection.pdf}
\caption{\small Operación de intersección de dos capas de polígonos.}
\label{Fig:Intersection} 
\end{figure}

\subsection{Transformaciones}

Podemos englobar dentro de este grupo una amplia serie de procedimientos que modifican los elementos de entrada de diversas formas. Entre los más habituales, encontramos la \textbf{transformación de coordenadas}, la \textbf{simplificación de geometrías}, o la \textbf{creación de áreas de influencia} o la \textbf{reclasificación de valores}. Estas transformación pueden afectar tanto a la componente espacial como a la componente temática del dato. 

Un caso particular, ya mencionado en un capítulo anterior, es la \textbf{conversión entre modelos de datos}, esto es, entre el modelo ráster y el vectorial. La figura \ref{Fig:Conversions} muestra un ejemplo de esto. Partiendo de un mapa escaneado (una capa ráster) con curvas de nivel, pueden detectarse estas y crearse una capa vectorial con dichas curvas de nivel. Estas pueden posteriormente convertirse en un Modelo Digital de Elevaciones (ráster) mediante \textbf{interpolación}, el cual es posible convertir de nuevo en una capa vectorial de líneas.

\begin{figure}[!hbt]   
\centering
\includegraphics[width= \columnwidth]{Analysis/Conversions.png}
\caption{\small Conversión entre distintos modelos de datos para una capa de elevaciones.}
\label{Fig:Conversions} 
\end{figure}

\subsection{Análisis de superficies}

El análisis de superficies es uno de los más potentes de cuantos encontramos en un SIG. Desde parámetros básicos como la \textbf{pendiente} o la \textbf{orientación} hasta parámetros morfométricos muy específicos, pasando por todas las herramientas del \textbf{análisis hidrológico}, la batería de operaciones disponibles es muy amplia. 

\subsection{Estadística descriptiva}

Los elementos de la estadística clásica tienen sus equivalentes en los datos espaciales, y nos permiten \textbf{calificar cuantitativamente} los datos con los que trabajamos. Se incluyen aquí descriptores de centralidad y dispersión, de dependencia espacial o el estudio de patrones espaciales, entre otros muchos. Estos pueden a su vez usarse para el contraste de hipótesis que contengan una cierta componente espacial.

Por ejemplo, estos estadísticos nos permiten dar respuesta a cuestiones del tipo:

\begin{itemize}
\item ¿Es constante la media de altura a lo largo de toda la geografía de mi país?

\item ¿Existe alguna dirección predominante en los movimientos de individuos de una especie o se desplazan erráticamente?
\end{itemize}

\subsection{Inferencia}

Otro análisis estadístico de gran importancia en los SIG es el que permite inferir comportamientos de las distintas variables y estudiar, por ejemplo, la forma en que estas van a evolucionar a lo largo del tiempo.

El establecimiento de modelos de cambio y variación representa una de las herramientas más actuales en el campo de los SIG, y un campo en abundante desarrollo.

\subsection{Toma de decisiones y optimización}

La estructura de la información geográfica en capas dentro de un SIG, favorable como ya vimos para la superposición de capas, lo es igualmente para estudiar de forma combinada los efectos de distintos factores. Este estudio nos permite luego responder a cuestiones como, por ejemplo:

\begin{itemize}
\item ¿Cuál es el mejor lugar para emplazar una nueva construcción en función de su impacto sobre el medio?

\item ¿Dónde situar un nuevo hospital para que el servicio en la comarca mejore lo máximo posible?
\end{itemize}

\subsection{Modelización}

La creación de modelos espaciales dentro de un SIG es una tarea aún pendiente de mucho desarrollo. No obstante, existe un gran número de modelos en los más diversos campos, y la arquitectura de datos y procesos de los SIG es propicia para la implementación de otros nuevos.


\section{Particularidades de los datos espaciales para su análisis}

Las características propias de los datos espaciales dotan a estos de una \textbf{gran potencialidad} de análisis, al tiempo que \textbf{condicionan o limitan} otras operaciones. Algunas de estas características representan problemas que han de tenerse presentes en el análisis; otros son simplemente conceptos básicos que deben conocerse pero no han de implicar necesariamente una dificultad asociada.

\subsection{Escala}


A la hora de estudiar la información geográfica, podemos hacerlo a \textbf{distintos niveles} y, dependiendo del nivel elegido, los resultados serán de una u otra naturaleza. Debido a esto, además de considerar la escala cartográfica para la representación y gestión de datos en un SIG, es necesario considerar la \textbf{escala de análisis}.

La escala de análisis depende \textbf{del dato en sí} (precisión, tipo, etc.), así como del \textbf{análisis que se va a realizar} con él.

Como se muestra en la figura \ref{Fig:Scales}, si para definir las formas de relieve en un punto dado lo hacemos considerando dicho punto y los valores de elevación a su alrededor, la caracterización que hagamos varía en función de la dimensión de esa zona alrededor (que es la que define la escala de análisis). Para valores pequeños de dicha zona de análisis, el punto analizado puede definirse como una cima, mientras que aumentando la escala de análisis se advierte que el punto se sitúa en el fondo de un valle.

\begin{figure}[h]   
\centering
\includegraphics[width= .45\columnwidth]{Analysis/Scales.pdf}
\caption{\small Dependiendo de la escala de análisis, un mismo relieve puede ser caracterizado como cima (a) o fondo de valle (b)}
\label{Fig:Scales} 
\end{figure}

Por tanto, debemos observar el relieve desde la distancia correcta a la cual la información que nos proporciona es la más adecuada para un análisis dado. Además de existir una escala de mayor relevancia para un análisis concreto,  es de interés el trabajar a \textbf{múltiples escalas} y combinar los resultados.

Otro ejemplo de cómo la escala de análisis condiciona los resultados obtenidos lo encontramos en el caso de efectuar \textbf{mediciones}. Como puede verse en la figura \ref{Fig:Fractal_line}, la unidad de medida empleada provoca que se obtengan resultados distintos. 

\begin{figure}[h]   
\centering
\includegraphics[width= .45\columnwidth]{Analysis/Fractal_line.pdf}
\caption{\small La unidad de medida empleada modifica el resultado obtenido.}
\label{Fig:Fractal_line} 
\end{figure}

La unión del valor resultante con la escala a la que se ha obtenido tiene en conjunto pleno significado, pero ese valor por sí mismo carece de dicho significado. 

El concepto de \textbf{fractal} tiene una implicación directa en este hecho.

El propio \textbf{formato de almacenamiento} condiciona el efecto de la escala, ya que puede imponer límites. Tal es el caso cuando se trabaja con capas raster, en las que el \textbf{tamaño de celda} delimita la precisión que puede obtenerse en el análisis.

\subsection{El Problema de la Unidad de Área Modificable}

Muchas de las variables con las que trabajamos dentro de un SIG \textbf{no pueden medirse de forma puntual}, y por ello han de \textbf{estudiarse para un área dada}. Ejemplos de este tipo de variables son el porcentaje de población en un rango de edad determinado o la densidad media de población.

Las áreas que se definen para poder trabajar con las variables de esta índole son \textbf{esencialmente arbitrarias}, tales como países, regiones o distritos, que se establece sin ningún criterio propio del análisis espacial. La utilización de una u otra unidad \textbf{altera los resultados} extraídos de las variables estudiadas.

Este problema, por tener relación con la elección de la unidad de agregación de la información, se conoce como \emph{Problema de la Unidad de Área Modificable} (PUAM).


Un problema particular relacionado con el PUAM es la denominada \textbf{falacia ecológica}, que consiste en asumir que los valores calculados para una unidad de área pueden aplicarse a los individuos de la población existente en dicha área. Sólo en el caso de que exista una completa homogeneidad para la variable analizada, lo cual raramente sucede, la anterior suposición sería cierta.

\subsection{Autocorrelación espacial} 

Se denomina \textbf{autocorrelación espacial} a la existencia de una \textbf{correlación de la variable consigo misma}, de tal modo que los valores de esta variable en un punto guardan relación directa con los de esa misma variable en otros puntos cercanos. Por ejemplo, en el caso de medirse la temperatura, los puntos cerca de un foco de calor tendrán una temperatura mayor que aquellos cerca de focos fríos. Si estudiamos la distribución de una enfermedad infecciosa, es más probable que los casos se encuentren agrupados, de forma que la presencia de un alto número de casos implique también una alta incidencia en poblaciones cercanas.

Otra forma de expresar la autocorrelación espacial es mediante la conocida como \textbf{Primera Ley Geográfica de Tobler}, que establece que <<todo está relacionado con todo, pero las cosas próximas entre sí están más relacionadas que las distantes>>.

La autocorrelación espacial, tal y como se ha descrito antes, es \textbf{positiva}. Puede, no obstante, existir una autocorrelación espacial \textbf{negativa}, si los valores altos se rodean de valores bajos y viceversa.

En caso de no existir ningún tipo de autocorrelación espacial, se tiene que los datos recogidos en una serie de puntos son \textbf{independientes entre sí} y no se afectan mutuamente, sin que tenga influencia de la distancia.

La figura \ref{Fig:Autocorrelation} muestra unas sencillas capas ráster en las que se presentan los tres tipos de autocorrelación espacial anteriores.

\begin{figure}[!hbt]   
\centering
\includegraphics[width=\textwidth]{Analysis/Autocorrelation.png}
\caption{\small a) Autocorrelación espacial positiva. b) Autocorrelación espacial negativa. c) Ausencia de autocorrelación espacial (independencia)}
\label{Fig:Autocorrelation} 
\end{figure}

Las consecuencias de la existencia de autocorrelación espacial son numerosas y de gran importancia.

Por una parte, muchos de los análisis estadísticos suponen la \textbf{independencia de la variable}. Puesto que existe una dependencia de la componente espacial, será necesario para obtener resultados correctos introducir dicha componente espacial como una variable más. 

Algo similar sucede cuando los datos presentan alguna \textbf{tendencia espacial} (los valores de una variable están relacionados con sus propias coordenadas geográficas), ya que esto tambien invalida el supuesto de la independencia de los datos.

Existiendo autocorrelación espacial, y siendo esta positiva, la \textbf{inferencia estadística es menos eficaz} que si se cuenta con un número igual de observaciones de una variable independiente. 

La autocorrelación espacial no es, no obstante, un elemento que siempre tenga consecuencias negativas. Puesto que los puntos cercanos a uno dado guardan relación con este, la autocorrelación puede aprovecharse para \textbf{estimar valores} en un punto cualquiera si conocemos los valores en puntos cercanos. Este es el fundamento de los \textbf{métodos de interpolación}


\subsection{Existencia de estructura}

Tanto la disposición de los datos como las propiedades de la variable estudiada (por ejemplo, la propia autocorrelación espacial como propiedad intrínseca) exhiben una estructura determinada. Esta estructura puede condicionar los resultados del análisis y tener influencia sobre estos.

Los dos principales conceptos estadísticos que definen la estructura espacial de los datos son la \textbf{estacionaridad} y la \textbf{isotropía}. La estacionaridad indica que el proceso es \textbf{invariante a la traslación}. Es decir, que las propiedades son constantes en el espacio y no existe tendencia alguna. La isotropía indica que el proceso es \textbf{invariante a la rotación} y tiene lugar del mismo modo en todas direcciones. 


\subsection{Efectos de borde}


Las zonas que estudiamos dentro de todo análisis espacial \textbf{tienen unos límites establecidos}. Estos límites vienen definidos de forma artificial ---el límite de la fotografía aérea de la que disponemos, por ejemplo--- o bien de forma natural ---si estudiamos un bosque junto a un pantano, el bosque encuentra su límite al borde de este último---. La presencia de estos bordes \textbf{distorsiona el resultado de los análisis}, en especial para aquellos parámetros no puntuales que requieren la definición de un area de estudio (densidades, etc., como ya vimos para el caso del PUAM)

En algunos casos, el efecto de borde no se manifiesta únicamente para puntos cercanos a dicho borde, sino para \textbf{todos aquellos relacionados o conectados} con él según un determinado criterio, con independencia de su distancia a este.


\pagestyle{empty}